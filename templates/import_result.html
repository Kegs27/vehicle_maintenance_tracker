<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Import Result - Vehicle Maintenance Tracker</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet"
          href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
          integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA=="
          crossorigin="anonymous" referrerpolicy="no-referrer">
    <link rel="icon" type="image/svg+xml" href="/favicon.svg?v=1">
    <link rel="icon" href="/favicon.ico?v=1" sizes="any">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png?v=1">
    <style>
        .result-card {
            border: none;
            border-radius: 15px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        /* Button styles are now centralized in app-styles.css */
        
        /* Background styling */
        body {
            background-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 800"><defs><pattern id="tools" patternUnits="userSpaceOnUse" width="200" height="200"><g fill="%23f8f9fa" opacity="0.1"><path d="M20 20h40v40h-40z"/><circle cx="40" cy="40" r="15"/><path d="M60 30h20v20h-20z"/><path d="M90 35h10v10h-10z"/><path d="M110 25h15v30h-15z"/><path d="M135 30h20v20h-20z"/><path d="M160 35h15v10h-15z"/><path d="M180 25h20v30h-20z"/><path d="M25 70h30v20h-30z"/><path d="M65 75h25v10h-25z"/><path d="M100 70h20v20h-20z"/><path d="M130 75h25v10h-25z"/><path d="M165 70h20v20h-20z"/><path d="M30 100h40v30h-40z"/><path d="M80 105h30v20h-30z"/><path d="M120 100h40v30h-40z"/><path d="M170 105h30v20h-30z"/><path d="M40 140h20v20h-20z"/><path d="M70 140h20v20h-20z"/><path d="M100 140h20v20h-20z"/><path d="M130 140h20v20h-20z"/><path d="M160 140h20v20h-20z"/><path d="M50 170h10v10h-10z"/><path d="M80 170h10v10h-10z"/><path d="M110 170h10v10h-10z"/><path d="M140 170h10v10h-10z"/><path d="M170 170h10v10h-10z"/></g></pattern><pattern id="vehicles" patternUnits="userSpaceOnUse" width="300" height="200"><g fill="%23e9ecef" opacity="0.08"><path d="M50 50h200v100h-200z"/><path d="M70 70h160v60h-160z"/><path d="M80 80h140v40h-140z"/><path d="M90 90h120v20h-120z"/><path d="M100 100h100v10h-100z"/><path d="M110 110h80v5h-80z"/><path d="M120 120h60v3h-60z"/><path d="M130 130h40v2h-40z"/><path d="M140 140h20v1h-20z"/><path d="M150 150h10v0.5h-10z"/><path d="M160 160h5v0.25h-5z"/><path d="M170 170h2.5v0.125h-2.5z"/><path d="M180 180h1.25v0.0625h-1.25z"/><path d="M190 190h0.625v0.03125h-0.625z"/><path d="M200 200h0.3125v0.015625h-0.3125z"/><path d="M210 210h0.15625v0.0078125h-0.15625z"/><path d="M220 220h0.078125v0.00390625h-0.078125z"/><path d="M230 230h0.0390625v0.001953125h-0.0390625z"/><path d="M240 240h0.01953125v0.0009765625h-0.01953125z"/><path d="M250 250h0.009765625v0.00048828125h-0.009765625z"/><path d="M260 260h0.0048828125v0.000244140625h-0.0048828125z"/><path d="M270 270h0.00244140625v0.0001220703125h-0.00244140625z"/><path d="M280 280h0.001220703125v0.00006103515625h-0.001220703125z"/><path d="M290 290h0.0006103515625v0.000030517578125h-0.0006103515625z"/><path d="M300 300h0.00030517578125v0.0000152587890625h-0.00030517578125z"/></g></pattern></defs><rect width="1200" height="800" fill="%23ffffff"/><rect width="1200" height="800" fill="url(%23tools)"/><rect width="1200" height="800" fill="url(%23vehicles)"/></svg>');
            background-attachment: fixed;
            background-size: cover;
            position: relative;
        }
        
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.05) 0%, rgba(124, 58, 237, 0.05) 100%);
            z-index: -1;
        }
        
        /* Content styling to stand out against background */
        .navbar {
            background: rgba(255, 255, 255, 0.95) !important;
            backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(139, 92, 246, 0.1);
        }
        
        .card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(139, 92, 246, 0.1);
            box-shadow: 0 8px 32px rgba(139, 92, 246, 0.1);
        }
        
        .alert {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(139, 92, 246, 0.1);
        }
        .nav-link {
            color: #6c757d;
            font-weight: 500;
        }
        .nav-link:hover {
            color: #495057;
        }
        .stats-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 15px;
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    {% include 'nav.html' %}

    <div class="container py-5">
        <div class="row justify-content-center">
            <div class="col-md-10">
                <div class="card result-card" style="background-color: #f8f9fa; border: 2px solid #dee2e6 !important;">
                    <div class="card-header bg-primary text-white text-center py-3">
                        <h4 class="mb-0">
                            <span class="icon-row">
                                <i class="fa-solid fa-check icon-m icon-base"></i>
                                <span>Import Complete</span>
                            </span>
                        </h4>
                    </div>
                    <div class="card-body p-4">
                        <!-- Statistics -->
                        <div class="row g-3 mb-4">
                            <div class="col-md-3">
                                <div class="card stats-card text-center" style="background-color: #f8f9fa; border: 2px solid #dee2e6 !important;">
                                    <div class="card-body">
                                        <h3 class="mb-1">{{ result.total_rows }}</h3>
                                        <p class="mb-0">Total Rows</p>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="card stats-card text-center" style="background-color: #f8f9fa; border: 2px solid #dee2e6 !important;">
                                    <div class="card-body">
                                        <h3 class="mb-1">{{ result.imported_rows }}</h3>
                                        <p class="mb-0">Imported</p>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="card stats-card text-center" style="background-color: #f8f9fa; border: 2px solid #dee2e6 !important;">
                                    <div class="card-body">
                                        <h3 class="mb-1">{{ result.skipped_rows }}</h3>
                                        <p class="mb-0">Skipped</p>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="card stats-card text-center" style="background-color: #f8f9fa; border: 2px solid #dee2e6 !important;">
                                    <div class="card-body">
                                        <h3 class="mb-1">{{ result.duplicate_rows }}</h3>
                                        <p class="mb-0">Duplicates</p>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Success Message -->
                        {% if result.imported_rows > 0 %}
                        <div class="alert alert-success">
                            <h6 class="alert-heading">
                                <span class="icon-row">
                                    <i class="fa-solid fa-check icon-m icon-base"></i>
                                    <span>Import Successful!</span>
                                </span>
                            </h6>
                            <p class="mb-0">
                                Successfully imported {{ result.imported_rows }} maintenance record{{ 's' if result.imported_rows != 1 else '' }}.
                                {% if result.skipped_rows > 0 %}
                                {{ result.skipped_rows }} rows were skipped due to validation issues.
                                {% endif %}
                                {% if result.duplicate_rows > 0 %}
                                {{ result.duplicate_rows }} duplicate records were handled according to your selection.
                                {% endif %}
                                {% if result.imported_rows > 0 %}
                                <br><small class="text-muted">
                                    <i class="fa-solid fa-circle-info me-1"></i>
                                    Records without dates will use placeholder date (01/01/1900) and be sorted by mileage. Records without mileage will use placeholder mileage (0) and be sorted by date.
                                </small>
                                {% endif %}
                            </p>
                        </div>
                        {% endif %}

                        <!-- Errors -->
                        {% if result.errors %}
                        <div class="alert alert-danger">
                            <h6 class="alert-heading">
                                <span class="icon-row">
                                    <i class="fa-solid fa-triangle-exclamation icon-m icon-base"></i>
                                    <span>Import Errors</span>
                                </span>
                            </h6>
                            <ul class="mb-0">
                                {% for error in result.errors %}
                                <li>{{ error }}</li>
                                {% endfor %}
                            </ul>
                        </div>
                        {% endif %}

                        <!-- Skipped Details -->
                        {% if result.skipped_details %}
                        <div class="alert alert-warning">
                            <h6 class="alert-heading">
                                <span class="icon-row">
                                    <i class="fa-solid fa-circle-info icon-m icon-base"></i>
                                    <span>Skipped Rows Details</span>
                                </span>
                            </h6>
                            <ul class="mb-0">
                                {% for detail in result.skipped_details %}
                                <li>{{ detail }}</li>
                                {% endfor %}
                            </ul>
                        </div>
                        {% endif %}

                        <!-- Duplicate Details -->
                        {% if result.duplicate_details %}
                        <div class="alert alert-info">
                            <h6 class="alert-heading">
                                <span class="icon-row">
                                    <i class="fa-solid fa-copy icon-m icon-base"></i>
                                    <span>Duplicate Records Found</span>
                                </span>
                            </h6>
                            <p class="mb-2">
                                The following records were skipped because they already exist in the database:
                            </p>
                            <ul class="mb-0">
                                {% for detail in result.duplicate_details %}
                                <li>{{ detail }}</li>
                                {% endfor %}
                            </ul>
                        </div>
                        {% endif %}

                        <!-- Action Buttons -->
                        <div class="d-flex gap-2 justify-content-center flex-wrap">
                            <a href="/maintenance" class="btn btn-primary">
                                <span class="icon-row">
                                    <i class="fa-solid fa-screwdriver-wrench icon-m icon-base"></i>
                                    <span>View Maintenance Records</span>
                                </span>
                            </a>
                            <a href="/import" class="btn btn-outline-primary">
                                <span class="icon-row">
                                    <i class="fa-solid fa-upload icon-m icon-base"></i>
                                    <span>Import Another File</span>
                                </span>
                            </a>
                            <a href="/" class="btn btn-outline-secondary">
                                <span class="icon-row">
                                    <i class="fa-solid fa-house icon-m icon-base"></i>
                                    <span>Back to Home</span>
                                </span>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="/static/export-data.js?v=3"></script>
    <script>
        function showOilChangeMenu() {
            // Redirect to vehicles page for oil change management
            window.location.href = '/vehicles';
        }
    </script>
</body>
</html>
